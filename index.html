<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>林育慧D3-HW3</title>
    <script src="https://d3js.org/d3.v3.js"></script>
    <style>
        * {
            font-family: Microsoft JhengHei, Arial;
        }
        
        div.ex {
            margin: 2em;
        }
        
        span {
            background: midnightblue;
            color: white;
            font-size: 12px;
            font-weight: 700;
        }
    </style>
</head>

<body>
    <!---- ex1 ---->
    <div class="ex">
        <span>ex1</span>
        <br>
        <br>

        <svg id="svg1" width="550" height="250"></svg>
    </div>
    

    <!---- ex2 ---->
    <div id="ex2" class="ex">
        <span>ex2</span>
        <br><br>

        <div></div>
        <div></div>
    </div>


    <!--    <svg weith="400" height="400"></svg>-->

    <script>
        //ex1
        d3.json("invoice-taipei.json", function (dataSet) {
            //  console.log(dataSet);

            var svg = d3.select("#svg1");
            var count = 0;
            var x1 = 0;
            var x2 = 250;
            var y1 = 20;
            var y2 = 30;
            var y3 = 40;
            // Title
            d3.select("#svg1")
                .append("text")
                .attr({
                    x: x1,
                    y: y1,
                    "font-size": 6,
                    "font-weight": 700,
                    fill: "darkgray"
                }).text("2016/8 Taipei");
            d3.select("#svg1")
                .append("text")
                .attr({
                    x: x2,
                    y: y1,
                    "font-size": 6,
                    fill: "darkgray"
                }).text("發票金額(億)");
            // Bar Plot
            for (var i = 0; i < dataSet.length; i++) {
                if (
                    dataSet[i].date.indexOf("2016/8") > -1 &&
                    //                    dataSet[i].date === "2016/8/1" &&
                    dataSet[i].city === "臺北市" &&
                    dataSet[i].amount > 1000000000
                ) {
                    d3.select("#svg1")
                        .append("rect")
                        .attr({
                            x: x2,
                            y: y2 + 20 * count,
                            width: dataSet[i].amount / 100000000,
                            height: 12,
                            fill: "midnightblue"
                        });

                    d3.select("#svg1")
                        .append("text")
                        .attr({
                            x: x1,
                            y: y3 + 20 * count,
                            "font-size": 6,
                            "font-weight": 700,
                            fill: "midnightblue"
                        }).text(dataSet[i].industry);

                    d3.select("#svg1")
                        .append("text")
                        .attr({
                            x: x2 + dataSet[i].amount / 100000000 + 15,
                            y: y3 + 20 * count,
                            "font-size": 6,
                            fill: "lightgray"
                        }).text((dataSet[i].amount / 100000000).toFixed(2));
                    count++;
                }

            }
        });

        //ex2
        var arr = [85, 60, 99, 49, 77, 82];

        bind(arr);
        render();

        function bind(data) {
            var selection = d3.select("#ex2")
                .selectAll("div")
                .data(data);

            selection.enter().append("div");
            selection.exit().remove();
        }

        function render() {
            d3.select("#ex2")
                .selectAll("div")
                .style({
                    "font-weight": 700,
                    color: function (d) {
                        if (d < 70) {
                            return "red";
                        } else {
                            return "midnightblue";
                        }
                    }
                })
                .text(function (d, i) {
                    return (i + 1) + " : " + d;
                })
        }

        //        function bind(data) {
        //            var selection = d3.select("body")
        //                .selectAll("div")
        //                .data(data);
        //
        //            selection.enter().append("div");
        //            selection.exit().remove();
        //        }
        //
        //        function render() {
        //            d3.select("body")
        //                .selectAll("div")
        //                .style({
        //                    color: function (d) {
        //                        if (d < 70) {
        //                            return "red";
        //                        } else {
        //                            return "black";
        //                        }
        //                    }
        //                })
        //                .text(function (d, i) {
        //                    return (i + 1) + ":" + d;
        //                })
        //        }


        //        var arr = [85, 60, 95, 49, 77, 55];
        //        var body = d3.select("body");
        //        for (var i = 0; i < arr.length; i++) {
        //            if (arr[i] < 60) {
        //                body.append("div")
        //                    .text(arr[i])
        //                    .style({
        //                        "color": "red",
        //                        "background": "lighyellow"
        //                    });
        //                //                body.append("div")
        //                //                    .text(arr[i])
        //                //                    .attr("style", "color:red")
        //            } else if (arr[i] < 80) {
        //                body.append("div")
        //                    .text(arr[i])
        //                    .style({
        //                        "color": "blue"
        //                    });
        //            } else {
        //                body.append("div")
        //                    .text(arr[i]);
        //            }
        //        }


        //        // 讀取csv格式
        //        d3.csv("invoice-taipei.csv", function (dataSet) {
        ////                        console.log(dataSet);
        ////                        console.table(dataSet);
        //            var body = d3.select("body");
        //            for (var i = 0; i < dataSet.length; i++) {
        //                if (dataSet[i].number > 10000000) {
        //                    //console.log(dataSet[i].number);
        //                    body.append("div")
        //                        .text(dataSet[i].industry+" "+ dataSet[i].number);
        //                }
        //           }
        //        });
        //        

        //        // 讀取json格式
        //        d3.json("invoice-taipei.json", function (dataSet) {
        ////                        console.log(dataSet);
        ////                        console.table(dataSet);
        //            var body = d3.select("body");
        //            for (var i = 0; i < dataSet.length; i++) {
        //                if (
        ////                    dataSet[i].date.indexOf('2016/8')  &&
        //                    dataSet[i].date === "2016/8/1" &&
        //                    dataSet[i].city === "臺北市"  &&
        //                    dataSet[i].amount > 100000000 )
        //                   {
        //                    //console.log(dataSet[i].number);
        //                    body.append("div")
        //                        .text(dataSet[i].date +" "+ 
        //                              dataSet[i].city +" "+
        //                              dataSet[i].amount
        //                             );
        //                }
        //           }
        //        });


        //        var arr = [85, 60, 99, 49, 77, 82];
        //        for (var i = 0; i < arr.length; i++) {
        //            d3.select("body")
        //                .append("div")
        //                .datum(arr[i])
        //                //                .text("ok")
        //                .text(function (d) {
        //                    return d;
        //                });
        //        }

        //        d3.select("body")
        //                .selectAll("div")
        //                .data(arr)
        //                .text(function (d) {
        //                    return d;
        //                });
        //        console.log(d3.selectAll("div"));


        //        var selection = d3.select("body")
        //            .selectAll("div")
        //            .data(arr);
        //
        //        selection.text(function (d) {
        //            return d;
        //        });
        //
        //        selection.enter().append("div").text(function (d) {
        //            return d;
        //        });
        //
        //        selection.exit().remove();

        //                function bind(data) {
        //                    var selection = d3.select("body")
        //                        .selectAll("div")
        //                        .data(data);
        //                    
        //                    selection.enter().append("div");
        //                    selection.exit().remove();
        //                }
        ////        function render() {d3.selectAll("ex2").text(function (d) {
        ////                return d;
        ////            })
        ////        }
        //                function render() {
        //                    d3.select("body")
        //                        .selectAll("div")
        //                        .style({
        //                            color: function (d) {
        //                                if (d < 70) {
        //                                    return "red";
        //                                } else {
        //                                    return "black";
        //                                }
        //                            }
        //                        })
        //                        .text(function (d, i) {
        //                            return (i + 1) + ":" + d;
        //                        })
        //                }
    </script>

</body>

</html>